define("local_coptutor/chat",["jquery"],(function($){return{init:function(courseid){$("body").append('\n<style>\n#ai-chat-wrapper { position:fixed; bottom:20px; right:20px; z-index:9999; font-family: \'Segoe UI\', Arial, sans-serif; }\n#ai-chat-icon { width:60px; height:60px; background:#007bff; border-radius:50%; display:flex; align-items:center;\n    justify-content:center; cursor:pointer; box-shadow:0 4px 15px rgba(0,0,0,.2); font-size: 24px; }\n#ai-chat-window { display:none; width:400px; height:500px; background:#fff; border-radius:12px;\n    box-shadow:0 8px 24px rgba(0,0,0,.15); flex-direction:column; overflow:hidden; margin-bottom:15px; border: 1px solid #ddd; }\n#ai-chat-header { background:#007bff; color:#fff; padding:15px; font-weight:bold; display:flex;\n    justify-content:space-between; align-items: center; }\n#ai-chat-body { flex:1; padding:15px; overflow-y:auto; background:#f9f9fb; display:flex; flex-direction:column; gap:12px; }\n\n.chat-bubble { padding:12px 16px; border-radius:15px; max-width:85%; font-size:14px; line-height: 1.6; word-wrap: break-word; }\n.user-msg { background:#007bff; color:#fff; align-self:flex-end; border-bottom-right-radius: 2px; }\n.ai-msg { background:#ffffff; color:#333; align-self:flex-start; border-bottom-left-radius: 2px; border: 1px solid #e0e0e0; }\n\n.ai-msg p { margin: 0 0 10px 0; }\n.ai-msg h3, .ai-msg h4 { margin: 15px 0 5px 0; color: #007bff; font-size: 15px; }\n.ai-msg ul, .ai-msg ol { margin: 5px 0 10px 20px; padding: 0; }\n.ai-msg li { margin-bottom: 5px; }\n.ai-msg hr { border: 0; border-top: 1px solid #eee; margin: 12px 0; }\n.ai-msg a { color: #007bff; text-decoration: underline; }\n\n#ai-chat-footer { padding:10px; border-top:1px solid #eee; display:flex; gap:8px; background:#fff; }\n#ai-chat-input { flex:1; border:1px solid #ddd; border-radius:20px; padding:10px 15px; height:42px; resize:none; outline:none; }\n#ai-chat-send { background:#007bff; color:#fff; border:none; border-radius:50%; width:40px; height:40px; cursor:pointer; }\n.typing { font-style:italic; font-size:12px; color:#888; margin-left:10px; }\n</style>\n<div id="ai-chat-wrapper">\n    <div id="ai-chat-window">\n        <div id="ai-chat-header">\n            <span>AI Course Assistant</span>\n            <span id="close-chat" style="cursor:pointer; font-size:20px;">&times;</span>\n        </div>\n        <div id="ai-chat-body"></div>\n        <div id="ai-chat-footer">\n            <textarea id="ai-chat-input" placeholder="Ask a question..."></textarea>\n            <button id="ai-chat-send">âž¤</button>\n        </div>\n    </div>\n    <div id="ai-chat-icon">ðŸ’¬</div>\n</div>');const scrollToBottom=function(){const body=$("#ai-chat-body");body.animate({scrollTop:body[0].scrollHeight},300)},renderBubble=function(content,type){return $("<div>").addClass("chat-bubble "+type).html(content)};let historyLoaded=!1;const sendMessage=function(){const message=$("#ai-chat-input").val().trim();if(!message)return;$("#ai-chat-body").append(renderBubble(message,"user-msg")),$("#ai-chat-input").val("");const loadingId="loading-"+Date.now();$("#ai-chat-body").append('<div id="'+loadingId+'" class="typing">AI is thinking...</div>'),scrollToBottom(),fetch(M.cfg.wwwroot+"/local/coptutor/ajax.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:message,courseid:courseid})}).then((function(res){return res.json()})).then((function(data){$("#"+loadingId).remove(),$("#ai-chat-body").append(renderBubble(data.reply,"ai-msg")),scrollToBottom()})).catch((function(){$("#"+loadingId).text("Error: AI offline")}))};$("#ai-chat-icon").on("click",(function(){$("#ai-chat-window").fadeToggle(200).css("display","flex"),historyLoaded||(fetch(M.cfg.wwwroot+"/local/coptutor/history.php?courseid="+courseid).then((function(res){return res.json()})).then((function(history){$("#ai-chat-body").empty(),history.length?history.forEach((function(item){$("#ai-chat-body").append(renderBubble(item.question,"user-msg")),$("#ai-chat-body").append(renderBubble(item.answer,"ai-msg"))})):$("#ai-chat-body").append(renderBubble("Hello! How can I help you today?","ai-msg")),scrollToBottom()})),historyLoaded=!0)})),$("#close-chat").on("click",(function(){$("#ai-chat-window").fadeOut(200)})),$("#ai-chat-send").on("click",sendMessage),$("#ai-chat-input").on("keypress",(function(e){13!==e.which||e.shiftKey||(e.preventDefault(),sendMessage())}))}}}));

//# sourceMappingURL=chat.min.js.map