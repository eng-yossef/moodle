{"version":3,"file":"community.min.js","sources":["../src/community.js"],"sourcesContent":["/**\n * Global Community AMD module.\n *\n * @module     local_community/community\n * @copyright  2026 Youssef Khaled\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery'], function($) {\n\n    /**\n     * Initialize the community page.\n     *\n     * @returns {void}\n     */\n    function init() {\n\n        loadPosts();\n\n        /**\n         * Load all posts from backend.\n         *\n         * @returns {void}\n         */\n        function loadPosts() {\n\n            fetch(M.cfg.wwwroot + '/local/community/ajax/get_posts.php')\n                .then(function(res) {\n                    return res.json();\n                })\n                .then(function(posts) {\n\n                    let html = '<button id=\"ask\">Ask Question</button>';\n\n                    posts.forEach(function(p) {\n                        html += `\n                            <div class=\"post\">\n                                <h3>\n                                <a href=\"${M.cfg.wwwroot}/local/community/pages/post.php?id=${p.id}\">\n                                ${p.title}\n                                </a>\n                                </h3>\n                                <p>${p.firstname} ${p.lastname}</p>\n                                <div class=\"votes\">${p.votes} votes</div>\n                            </div>\n                        `;\n                    });\n\n                    $('#community-app').html(html);\n                });\n        }\n\n        /**\n         * Handle creating a new post.\n         *\n         * @returns {void}\n         */\n        $(document).on('click', '#ask', function() {\n\n            const title = prompt('Title');\n            const content = prompt('Content');\n\n            fetch(M.cfg.wwwroot + '/local/community/ajax/create_post.php', {\n                method: 'POST',\n                body: JSON.stringify({\n                    title: title,\n                    content: content,\n                    posttype: 'question'\n                })\n            }).then(function() {\n                loadPosts();\n            });\n\n        });\n\n    }\n\n    return {\n        init: init\n    };\n\n});"],"names":["define","$","init","loadPosts","fetch","M","cfg","wwwroot","then","res","json","posts","html","forEach","p","id","title","firstname","lastname","votes","document","on","prompt","content","method","body","JSON","stringify","posttype"],"mappings":";;;;;;;AAQAA,mCAAO,CAAC,WAAW,SAASC,SAqEjB,CACHC,yBAtDSC,YAELC,MAAMC,EAAEC,IAAIC,QAAU,uCACjBC,MAAK,SAASC,YACJA,IAAIC,UAEdF,MAAK,SAASG,WAEPC,KAAO,yCAEXD,MAAME,SAAQ,SAASC,GACnBF,iJAGmBP,EAAEC,IAAIC,sDAA6CO,EAAEC,kDAC9DD,EAAEE,mIAGCF,EAAEG,sBAAaH,EAAEI,6EACDJ,EAAEK,uFAKnClB,EAAE,kBAAkBW,KAAKA,SA/BrCT,YAwCAF,EAAEmB,UAAUC,GAAG,QAAS,QAAQ,iBAEtBL,MAAQM,OAAO,SACfC,QAAUD,OAAO,WAEvBlB,MAAMC,EAAEC,IAAIC,QAAU,wCAAyC,CAC3DiB,OAAQ,OACRC,KAAMC,KAAKC,UAAU,CACjBX,MAAOA,MACPO,QAASA,QACTK,SAAU,eAEfpB,MAAK,WACJL"}